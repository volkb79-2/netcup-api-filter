# RECOMMENDED: Use ./auto-detect-fqdn.sh to generate this file automatically
# It will detect your public IP, perform reverse DNS, and populate all paths.
#
# Manual setup: Copy this file to proxy.env and update the values for your host.

# ============================================================================
# DOMAIN CONFIGURATION (auto-detected by ./auto-detect-fqdn.sh)
# ============================================================================

# LOCAL_TLS_DOMAIN: Public FQDN where nginx will accept HTTPS connections
# - Used in nginx server_name directive
# - Used to construct certificate paths: /etc/letsencrypt/live/${LOCAL_TLS_DOMAIN}/
# - Auto-detected via reverse DNS lookup of external IP
# - Example: $PUBLIC_FQDN (for production Let's Encrypt certs)
# - Fallback: naf.localtest.me (uses self-signed test certs in ./certs/)
LOCAL_TLS_DOMAIN=$PUBLIC_FQDN

# ============================================================================
# BACKEND CONFIGURATION
# ============================================================================

# LOCAL_APP_HOST: Hostname/IP where Flask backend is reachable from nginx container
# - Typically the devcontainer hostname on shared Docker network
# - Set to __auto__ if using tooling/run-ui-validation.sh (auto-injects hostname)
# - Must be resolvable from within the local-proxy container
LOCAL_APP_HOST=netcup-api-filter-devcontainer

# LOCAL_APP_PORT: Port where Flask backend listens (HTTP, not HTTPS)
# - nginx forwards to http://${LOCAL_APP_HOST}:${LOCAL_APP_PORT}
# - Default: 5100 (gunicorn default for this project)
LOCAL_APP_PORT=5100

# ============================================================================
# PORT BINDINGS (host machine)
# ============================================================================

# LOCAL_TLS_BIND_HTTPS: Host port for HTTPS traffic (mapped to container port 443)
# - Production: 443 (standard HTTPS)
# - Development: 4443 (non-privileged alternative)
LOCAL_TLS_BIND_HTTPS=443

# LOCAL_TLS_BIND_HTTP: Host port for HTTP redirect (mapped to container port 80)
# - Redirects all HTTP traffic to HTTPS
# - Production: 80 (standard HTTP)
# - Development: 4080 (non-privileged alternative)
LOCAL_TLS_BIND_HTTP=80

# ============================================================================
# CERTIFICATE CONFIGURATION
# ============================================================================

# LE_CERT_BASE: Base directory for TLS certificates on host machine
#
# OPTION 1: Real Let's Encrypt certificates (RECOMMENDED for production parity)
# - Path: /etc/letsencrypt (standard Let's Encrypt location on host)
# - Structure: Must contain live/${LOCAL_TLS_DOMAIN}/ with fullchain.pem + privkey.pem
# - Symlinks: nginx follows symlinks to archive/ directory (disable_symlinks off)
# - Auto-detected: ./auto-detect-fqdn.sh sets this to /etc/letsencrypt
# - Requires: Certificates exist on Docker host (not devcontainer)
#
# OPTION 2: Self-signed test certificates (fallback for local testing)
# - Path: /tmp/netcup-local-proxy/certs (staged from ./certs/ directory)
# - Structure: Contains pre-generated certs for naf.localtest.me
# - Use case: Testing without access to real Let's Encrypt certificates
# - Caveat: Browsers will show security warnings (untrusted CA)
#
# Docker mount: ${LE_CERT_BASE}:/etc/letsencrypt:ro (read-only)
LE_CERT_BASE=/etc/letsencrypt

# ============================================================================
# DOCKER NETWORKING
# ============================================================================

# LOCAL_PROXY_NETWORK: Docker network name for proxy â†” backend communication
# - Must exist before starting: docker network create naf-local
# - Both nginx container and devcontainer must join this network
# - Used for hostname resolution (LOCAL_APP_HOST must be reachable)
LOCAL_PROXY_NETWORK=naf-dev-network

# ============================================================================
# STAGING PATHS (devcontainer only)
# ============================================================================

# LOCAL_PROXY_CONFIG_PATH: Host-visible path for rendered nginx configs
# - nginx container mounts: ${LOCAL_PROXY_CONFIG_PATH}:/etc/nginx/conf.d:ro
# - Required when Docker daemon can't read /workspaces/ (devcontainer limitation)
# - ./stage-proxy-inputs.sh copies ./conf.d/ here via Docker
# - Production: Can point directly to ./conf.d/ if accessible
LOCAL_PROXY_CONFIG_PATH=/tmp/netcup-local-proxy/conf.d
